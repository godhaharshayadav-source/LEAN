<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ACME Stamping: Lean Ops Dashboard</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Phosphor Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <!-- Canvas Confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #0f172a; }
        
        /* Dashboard Sidebar Styling */
        .nav-item { transition: all 0.2s; border-left: 3px solid transparent; }
        .nav-item:hover { background-color: #1e293b; }
        .nav-item.active { background-color: #1e293b; border-left-color: #e11d48; color: white; }
        .nav-item.active i { color: #e11d48; }
        
        /* Card Styling */
        .card { 
            background: white; 
            border: 1px solid #e2e8f0; 
            border-radius: 0.5rem; 
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            transition: transform 0.2s;
        }
        .card:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
        
        /* VSM Box Styling */
        .vsm-process {
            background: white;
            border: 2px solid #334155;
            padding: 0.5rem;
            width: 140px;
            text-align: center;
            position: relative;
            z-index: 10;
        }
        .vsm-data-box {
            background: #f1f5f9;
            border: 1px solid #cbd5e1;
            font-size: 0.7rem;
            text-align: left;
            padding: 4px;
            margin-top: 4px;
        }
        .vsm-arrow {
            flex-grow: 1;
            height: 2px;
            background: #94a3b8;
            position: relative;
            margin: 0 10px;
        }
        .vsm-arrow::after {
            content: '';
            position: absolute;
            right: 0; top: -4px;
            border-top: 5px solid transparent;
            border-bottom: 5px solid transparent;
            border-left: 6px solid #94a3b8;
        }
        .vsm-inventory {
            color: #ef4444;
            font-size: 1.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Toggle Switch */
        .toggle-checkbox:checked {
            right: 0;
            border-color: #e11d48;
        }
        .toggle-checkbox:checked + .toggle-label {
            background-color: #e11d48;
        }
        
        /* Timer Animation */
        @keyframes pulse-red {
            0% { box-shadow: 0 0 0 0 rgba(225, 29, 72, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(225, 29, 72, 0); }
            100% { box-shadow: 0 0 0 0 rgba(225, 29, 72, 0); }
        }
        .recording {
            animation: pulse-red 2s infinite;
        }

        /* Heartbeat Animation for OEE */
        @keyframes heartbeat {
            0% { transform: scale(1); }
            15% { transform: scale(1.3); }
            30% { transform: scale(1); }
            45% { transform: scale(1.15); }
            60% { transform: scale(1); }
        }
        .animate-heartbeat {
            animation: heartbeat 2s infinite;
            display: inline-block;
        }

        /* Sticky Note Styling */
        .sticky-note {
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .sticky-note:hover {
            transform: scale(1.05) rotate(1deg);
            z-index: 10;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2);
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px) scale(0.9); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        .animate-fade-in {
            animation: fadeIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        /* Toast Notification */
        #toast-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 50;
        }
        .toast {
            background: white;
            border-left: 4px solid #22c55e;
            padding: 1rem;
            border-radius: 4px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            display: flex;
            align-items: center;
            gap: 12px;
            min-width: 300px;
            transform: translateX(120%);
            transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        }
        .toast.show {
            transform: translateX(0);
        }

        /* Panic Button */
        .panic-btn {
            background: radial-gradient(circle at 30% 30%, #ef4444, #991b1b);
            box-shadow: 0 10px 0 #7f1d1d, 0 10px 20px rgba(0,0,0,0.4);
            transition: all 0.1s;
        }
        .panic-btn:active {
            transform: translateY(5px);
            box-shadow: 0 5px 0 #7f1d1d, 0 5px 10px rgba(0,0,0,0.4);
        }
        .panic-overlay {
            position: fixed;
            inset: 0;
            background: rgba(220, 38, 38, 0.3);
            z-index: 100;
            display: none;
            align-items: center;
            justify-content: center;
            animation: flash 0.5s infinite;
            pointer-events: none;
        }
        @keyframes flash {
            0%, 100% { opacity: 0; }
            50% { opacity: 1; }
        }
    </style>
</head>
<body class="flex h-screen overflow-hidden bg-slate-50">

    <!-- Toast Container -->
    <div id="toast-container"></div>
    
    <!-- Panic Overlay -->
    <div id="panic-overlay" class="panic-overlay">
        <div class="bg-red-600 text-white px-10 py-6 rounded-xl shadow-2xl border-4 border-white text-4xl font-black transform rotate-2">
            ⚠️ LINE STOPPED! HELP NEEDED! ⚠️
        </div>
    </div>

    <!-- Sidebar -->
    <aside class="w-64 bg-slate-900 text-slate-400 flex flex-col flex-shrink-0 z-20 shadow-2xl">
        <div class="p-6 border-b border-slate-800 flex items-center gap-3">
            <div class="w-10 h-10 bg-rose-600 rounded-lg flex items-center justify-center text-white font-black text-xl shadow-lg shadow-rose-900/50">A</div>
            <div>
                <h1 class="text-white font-bold leading-tight tracking-tight">ACME<br>Stamping</h1>
            </div>
        </div>

        <nav class="flex-1 overflow-y-auto py-6 space-y-2 px-2">
            <button onclick="switchTab('define')" id="btn-define" class="nav-item w-full flex items-center gap-3 px-4 py-3 text-left active rounded-lg">
                <i class="ph ph-target text-xl"></i>
                <span class="font-medium text-sm">1. Define & Quantify</span>
            </button>
            <button onclick="switchTab('map')" id="btn-map" class="nav-item w-full flex items-center gap-3 px-4 py-3 text-left rounded-lg">
                <i class="ph ph-tree-structure text-xl"></i>
                <span class="font-medium text-sm">2. Value Stream Map</span>
            </button>
            <button onclick="switchTab('countermeasures')" id="btn-countermeasures" class="nav-item w-full flex items-center gap-3 px-4 py-3 text-left rounded-lg">
                <i class="ph ph-wrench text-xl"></i>
                <span class="font-medium text-sm">3. Solution Simulator</span>
            </button>
            <button onclick="switchTab('control')" id="btn-control" class="nav-item w-full flex items-center gap-3 px-4 py-3 text-left rounded-lg">
                <i class="ph ph-chart-line-up text-xl"></i>
                <span class="font-medium text-sm">4. Shop Floor Control</span>
            </button>
            <button onclick="switchTab('gemba')" id="btn-gemba" class="nav-item w-full flex items-center gap-3 px-4 py-3 text-left rounded-lg">
                <i class="ph ph-binoculars text-xl"></i>
                <span class="font-medium text-sm">5. Gemba & Kaizen</span>
            </button>
        </nav>

        <div class="p-4 bg-slate-800 mx-2 mb-2 rounded-xl border border-slate-700">
            <div class="flex items-center gap-3 mb-3">
                <div class="relative">
                    <img src="https://ui-avatars.com/api/?name=John+Doe&background=334155&color=fff" class="w-10 h-10 rounded-full border-2 border-slate-600">
                    <span class="absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-slate-800"></span>
                </div>
                <div>
                    <p class="text-xs text-white font-bold">J. Smith</p>
                    <p class="text-[10px] text-slate-400">Plant Manager</p>
                </div>
            </div>
            <div class="flex justify-between text-[10px] text-slate-400 border-t border-slate-700 pt-2 mt-2">
                <span>Shift: A</span>
                <span>Line: 4</span>
                <span class="text-green-400 font-bold animate-pulse">● Online</span>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 overflow-y-auto relative bg-slate-50">
        <!-- Top Bar -->
        <header class="bg-white/80 backdrop-blur-md border-b border-slate-200 sticky top-0 z-10 px-8 py-4 flex justify-between items-center shadow-sm">
            <div>
                <h2 class="text-xl font-bold text-slate-800 flex items-center gap-2" id="page-title">Define the Problem</h2>
                <div class="flex items-center gap-2 text-xs text-slate-500 mt-1">
                    <span class="bg-rose-50 text-rose-700 px-2 py-0.5 rounded border border-rose-100 font-bold">SMED-2025</span>
                    <i class="ph ph-caret-right"></i>
                    <span id="page-subtitle">Problem Statement</span>
                </div>
            </div>
            <div class="flex gap-4 items-center">
                <div class="text-right border-r border-slate-200 pr-4 hidden md:block">
                    <p class="text-[10px] text-slate-400 uppercase font-bold tracking-wider">Current OEE</p>
                    <div class="flex items-center gap-1 justify-end">
                        <i class="ph ph-heartbeat text-rose-500 animate-heartbeat text-lg"></i>
                        <p class="text-xl font-black text-slate-800">85%</p>
                    </div>
                </div>
                <button onclick="showToast('PDF Export started...')" class="bg-white border border-slate-200 text-slate-700 px-4 py-2 rounded-lg shadow-sm hover:bg-slate-50 hover:shadow-md transition-all text-sm font-bold flex items-center gap-2 group">
                    <i class="ph ph-download-simple group-hover:scale-110 transition-transform"></i> Export
                </button>
                <button class="bg-rose-600 text-white px-4 py-2 rounded-lg shadow-lg shadow-rose-200 hover:bg-rose-700 hover:shadow-rose-300 hover:-translate-y-0.5 transition-all text-sm font-bold flex items-center gap-2">
                    <i class="ph ph-share-network"></i> Share
                </button>
            </div>
        </header>

        <div class="p-8 max-w-7xl mx-auto">
            
            <!-- VIEW 1: DEFINE -->
            <div id="view-define" class="view-section block animate-fade-in">
                <div class="grid grid-cols-12 gap-6">
                    <!-- Problem Card -->
                    <div class="col-span-12 lg:col-span-8 card p-8 border-l-8 border-l-rose-500 relative overflow-hidden group">
                        <div class="absolute -right-10 -top-10 text-rose-50 opacity-20 group-hover:opacity-30 transition-opacity transform rotate-12">
                            <i class="ph ph-warning-octagon text-[150px]"></i>
                        </div>
                        <div class="flex justify-between items-start mb-6 relative z-10">
                            <h3 class="font-bold text-2xl text-slate-800">Problem Statement</h3>
                            <span class="bg-red-100 text-red-700 px-3 py-1 rounded-full text-xs font-black border border-red-200 animate-pulse">CRITICAL</span>
                        </div>
                        <p class="text-slate-600 text-base leading-relaxed mb-6 relative z-10">
                            ACME Stamping is experiencing excessive changeover times (60 min for Stamping, 10 min for Welding). This forces large batch production, resulting in high WIP and a <strong class="text-rose-600 bg-rose-50 px-1 rounded">lead time of 8-10 days</strong>, failing to meet the customer's need for flexibility and daily shipments.
                        </p>
                        <div class="grid grid-cols-3 gap-6 mt-4 relative z-10">
                            <div class="bg-slate-50 p-4 rounded-xl border border-slate-200 text-center hover:bg-white hover:shadow-lg transition-all cursor-default">
                                <span class="text-[10px] text-slate-400 uppercase font-black tracking-widest">Setup Time</span>
                                <div class="text-3xl font-black text-slate-800 mt-1">60 <span class="text-sm font-bold text-slate-400">min</span></div>
                            </div>
                            <div class="bg-slate-50 p-4 rounded-xl border border-slate-200 text-center hover:bg-white hover:shadow-lg transition-all cursor-default">
                                <span class="text-[10px] text-slate-400 uppercase font-black tracking-widest">Lead Time</span>
                                <div class="text-3xl font-black text-rose-600 mt-1">9 <span class="text-sm font-bold text-rose-400">days</span></div>
                            </div>
                            <div class="bg-slate-50 p-4 rounded-xl border border-slate-200 text-center hover:bg-white hover:shadow-lg transition-all cursor-default">
                                <span class="text-[10px] text-slate-400 uppercase font-black tracking-widest">Cust. Demand</span>
                                <div class="text-3xl font-black text-slate-800 mt-1">18.4k <span class="text-sm font-bold text-slate-400">/mo</span></div>
                            </div>
                        </div>
                    </div>

                    <!-- Customer Context -->
                    <div class="col-span-12 lg:col-span-4 card p-8 flex flex-col justify-between">
                        <div>
                            <h3 class="font-bold text-sm text-slate-400 mb-6 uppercase tracking-widest">Customer Voice</h3>
                            <div class="flex items-center gap-4 mb-6">
                                <div class="w-16 h-16 rounded-2xl bg-blue-50 text-blue-600 flex items-center justify-center border border-blue-100 shadow-sm">
                                    <i class="ph ph-buildings text-4xl"></i>
                                </div>
                                <div>
                                    <p class="font-black text-xl text-slate-800">State Street</p>
                                    <p class="text-xs text-blue-600 font-bold bg-blue-50 px-2 py-0.5 rounded inline-block mt-1">JIT Plant</p>
                                </div>
                            </div>
                        </div>
                        <div class="space-y-4">
                            <div class="flex justify-between text-sm items-center">
                                <span class="text-slate-500 font-medium">Takt Time Req.</span>
                                <span class="font-bold text-slate-800 bg-slate-100 px-2 py-1 rounded">~60 sec</span>
                            </div>
                            <div class="flex justify-between text-sm items-center">
                                <span class="text-slate-500 font-medium">Delivery Freq.</span>
                                <span class="font-bold text-slate-800 bg-slate-100 px-2 py-1 rounded">Daily</span>
                            </div>
                            <div class="pt-4 border-t border-slate-100">
                                <div class="flex justify-between text-xs mb-1">
                                    <span class="font-bold text-slate-400">Satisfaction Score</span>
                                    <span class="font-bold text-orange-500">80% (Risk)</span>
                                </div>
                                <div class="w-full bg-slate-100 h-2 rounded-full overflow-hidden">
                                    <div class="bg-orange-500 h-full rounded-full" style="width: 80%"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Pareto Chart -->
                    <div class="col-span-12 lg:col-span-6 card p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h4 class="font-bold text-slate-700">Loss Analysis (Pareto)</h4>
                            <span class="text-[10px] bg-slate-100 text-slate-500 px-2 py-1 rounded font-bold">Hours/Month</span>
                        </div>
                        <div class="h-56">
                            <canvas id="lossChart"></canvas>
                        </div>
                    </div>

                    <!-- Time Composition Chart -->
                    <div class="col-span-12 lg:col-span-6 card p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h4 class="font-bold text-slate-700">Total Time Composition</h4>
                            <span class="text-[10px] bg-slate-100 text-slate-500 px-2 py-1 rounded font-bold">Value Added Ratio</span>
                        </div>
                        <div class="h-56">
                            <canvas id="compositionChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 2: MAP (Interactive VSM) -->
            <div id="view-map" class="view-section hidden animate-fade-in">
                <div class="card p-8 min-h-[600px] relative overflow-hidden">
                    <div class="flex justify-between items-center mb-10 border-b border-slate-100 pb-6">
                        <div>
                            <h3 class="font-black text-2xl text-slate-800">Value Stream Map</h3>
                            <p class="text-sm text-slate-500 mt-1 flex items-center gap-1"><i class="ph ph-arrow-elbow-down-right"></i> Stamping &rarr; Weld &rarr; Ship</p>
                        </div>
                        <div class="flex items-center gap-2 bg-slate-100 p-1.5 rounded-xl border border-slate-200">
                            <button onclick="toggleVSM('current')" id="vsm-btn-current" class="px-6 py-2 rounded-lg text-sm font-bold bg-white shadow-md text-slate-800 transition-all hover:scale-105">Current State</button>
                            <button onclick="toggleVSM('future')" id="vsm-btn-future" class="px-6 py-2 rounded-lg text-sm font-medium text-slate-500 hover:text-slate-700 transition-all hover:bg-white/50">Future State</button>
                        </div>
                    </div>

                    <!-- VSM Diagram -->
                    <div class="flex items-start justify-center overflow-x-auto py-8 px-4" id="vsm-container">
                        <!-- Supplier -->
                        <div class="flex flex-col items-center mx-6 group">
                            <div class="w-24 h-16 bg-slate-800 text-white flex items-center justify-center rounded-xl text-xs font-black mb-3 shadow-xl group-hover:-translate-y-1 transition-transform cursor-pointer border-2 border-slate-600">Michigan<br>Steel</div>
                            <i class="ph ph-truck text-3xl text-slate-400 group-hover:text-slate-600 transition-colors"></i>
                            <span class="text-[10px] text-slate-400 font-bold mt-1 bg-slate-100 px-2 py-0.5 rounded">2x / Week</span>
                        </div>

                        <div class="vsm-arrow mt-8 w-20"></div>

                        <!-- Process 1: Stamping -->
                        <div class="flex flex-col gap-3 relative">
                            <div class="vsm-process shadow-lg rounded-lg group hover:border-blue-400 transition-colors">
                                <div class="font-bold text-sm text-slate-800">Stamping</div>
                                <div class="text-[10px] text-slate-500 font-medium">1 Press</div>
                                <div class="absolute -top-3 -right-3 w-8 h-8 bg-white rounded-full shadow border border-slate-100 flex items-center justify-center">
                                    <i class="ph ph-wrench text-slate-400 text-sm group-hover:text-blue-500 group-hover:rotate-45 transition-all"></i>
                                </div>
                            </div>
                            <div class="vsm-data-box rounded shadow-sm">
                                <div class="flex justify-between border-b border-slate-200 pb-1 mb-1"><span>C/T:</span> <b class="font-mono">1 sec</b></div>
                                <div class="flex justify-between text-red-600 font-bold bg-red-50 px-1 rounded transition-colors" id="val-stamping-co"><span>C/O:</span> <b>60 min</b></div>
                                <div class="flex justify-between transition-colors pt-1" id="val-stamping-avail"><span>Avail:</span> <b class="font-mono">85%</b></div>
                            </div>
                        </div>

                        <!-- Inventory Triangle -->
                        <div class="flex flex-col items-center justify-center px-8 mt-8 group cursor-pointer" onclick="showToast('Inventory Waste Identified!', 'error')">
                            <i class="ph ph-warning-triangle text-yellow-500 text-4xl animate-bounce drop-shadow-md group-hover:scale-125 transition-transform"></i>
                            <span class="text-xs font-black text-red-600 mt-2 bg-red-50 px-2 py-1 rounded border border-red-100" id="val-inventory">Huge WIP</span>
                            <span class="text-[10px] text-slate-400 font-bold mt-1">Buffers</span>
                        </div>

                        <!-- Process 2: Welding -->
                        <div class="flex flex-col gap-3">
                            <div class="vsm-process shadow-lg rounded-lg group hover:border-orange-400 transition-colors">
                                <div class="font-bold text-sm text-slate-800">Spot Weld</div>
                                <div class="text-[10px] text-slate-500 font-medium">2 Cells</div>
                            </div>
                            <div class="vsm-data-box rounded shadow-sm">
                                <div class="flex justify-between border-b border-slate-200 pb-1 mb-1"><span>C/T:</span> <b class="font-mono">40 sec</b></div>
                                <div class="flex justify-between text-orange-600 font-bold" id="val-weld-co"><span>C/O:</span> <b>10 min</b></div>
                                <div class="flex justify-between pt-1" id="val-weld-rel"><span>Rel:</span> <b class="font-mono">80%</b></div>
                            </div>
                        </div>

                        <div class="vsm-arrow mt-8 w-20"></div>

                        <!-- Customer -->
                        <div class="flex flex-col items-center mx-6 group">
                            <div class="w-24 h-16 bg-blue-600 text-white flex items-center justify-center rounded-xl text-xs font-black mb-3 shadow-xl shadow-blue-200 group-hover:-translate-y-1 transition-transform cursor-pointer border-2 border-blue-500">State<br>Street</div>
                            <i class="ph ph-truck text-3xl text-slate-400 group-hover:text-blue-500 transition-colors"></i>
                            <span class="text-[10px] text-slate-400 font-bold mt-1 bg-slate-100 px-2 py-0.5 rounded">Daily</span>
                        </div>
                    </div>

                    <!-- Lead Time Ladder -->
                    <div class="mt-16 mx-auto max-w-3xl transform hover:scale-105 transition-transform duration-500">
                        <div class="flex text-xs border-2 border-slate-300 rounded-xl overflow-hidden shadow-sm">
                            <div class="flex-1 bg-red-50 p-4 text-center text-red-700 font-black border-r-2 border-slate-300 transition-all flex flex-col items-center justify-center gap-1" id="ladder-lead">
                                <span class="uppercase tracking-widest opacity-50 text-[10px]">Total Lead Time</span>
                                <span class="text-2xl">9 Days</span>
                            </div>
                            <div class="flex-1 bg-green-50 p-4 text-center text-green-700 font-black flex flex-col items-center justify-center gap-1">
                                <span class="uppercase tracking-widest opacity-50 text-[10px]">Value Added Time</span>
                                <span class="text-2xl">41 Sec</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 3: COUNTERMEASURES (Simulator) -->
            <div id="view-countermeasures" class="view-section hidden animate-fade-in">
                <div class="grid grid-cols-12 gap-6">
                    <!-- Scenario Builder -->
                    <div class="col-span-12 lg:col-span-7 card p-0 overflow-hidden shadow-xl">
                        <div class="bg-slate-900 p-6 border-b border-slate-800">
                            <h3 class="font-black text-xl text-white flex items-center gap-2">
                                <i class="ph ph-faders text-rose-500"></i> SMED Simulator
                            </h3>
                            <p class="text-sm text-slate-400 mt-1">Select improvements to crush setup time.</p>
                        </div>
                        <div class="p-8 space-y-6">
                            
                            <!-- Toggle 1 -->
                            <div class="flex items-center justify-between p-5 border-2 border-slate-100 rounded-xl hover:border-green-400 hover:bg-green-50/30 transition-all cursor-pointer group">
                                <div class="flex gap-5 items-center">
                                    <div class="w-12 h-12 rounded-xl bg-green-100 text-green-600 flex items-center justify-center text-2xl group-hover:scale-110 transition-transform"><i class="ph ph-arrows-out-line-horizontal"></i></div>
                                    <div>
                                        <h4 class="font-bold text-slate-800 text-base">Externalize Setup</h4>
                                        <p class="text-xs text-slate-500 mt-1">Pre-stage dies while running (-30m)</p>
                                    </div>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" value="30" class="sr-only peer impact-toggle" onchange="updateSimulation()">
                                    <div class="w-14 h-7 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-green-500"></div>
                                </label>
                            </div>

                            <!-- Toggle 2 -->
                            <div class="flex items-center justify-between p-5 border-2 border-slate-100 rounded-xl hover:border-blue-400 hover:bg-blue-50/30 transition-all cursor-pointer group">
                                <div class="flex gap-5 items-center">
                                    <div class="w-12 h-12 rounded-xl bg-blue-100 text-blue-600 flex items-center justify-center text-2xl group-hover:scale-110 transition-transform"><i class="ph ph-wrench"></i></div>
                                    <div>
                                        <h4 class="font-bold text-slate-800 text-base">Quick Release Clamps</h4>
                                        <p class="text-xs text-slate-500 mt-1">One-touch mechanics (-15m)</p>
                                    </div>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" value="15" class="sr-only peer impact-toggle" onchange="updateSimulation()">
                                    <div class="w-14 h-7 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-blue-500"></div>
                                </label>
                            </div>

                            <!-- Toggle 3 -->
                            <div class="flex items-center justify-between p-5 border-2 border-slate-100 rounded-xl hover:border-purple-400 hover:bg-purple-50/30 transition-all cursor-pointer group">
                                <div class="flex gap-5 items-center">
                                    <div class="w-12 h-12 rounded-xl bg-purple-100 text-purple-600 flex items-center justify-center text-2xl group-hover:scale-110 transition-transform"><i class="ph ph-list-checks"></i></div>
                                    <div>
                                        <h4 class="font-bold text-slate-800 text-base">5S & Standard Work</h4>
                                        <p class="text-xs text-slate-500 mt-1">Zero search time (-5m)</p>
                                    </div>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" value="5" class="sr-only peer impact-toggle" onchange="updateSimulation()">
                                    <div class="w-14 h-7 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-purple-500"></div>
                                </label>
                            </div>

                        </div>
                    </div>

                    <!-- Results Panel -->
                    <div class="col-span-12 lg:col-span-5 flex flex-col gap-6">
                        <!-- Time Gauge -->
                        <div class="card p-8 flex flex-col items-center justify-center flex-1 relative overflow-hidden">
                            <h4 class="text-xs font-black text-slate-400 uppercase tracking-widest mb-6">Projected Setup Time</h4>
                            <div class="relative w-56 h-56 flex items-center justify-center transition-all duration-500" id="gauge-container">
                                <svg class="w-full h-full transform -rotate-90 drop-shadow-xl">
                                    <circle cx="112" cy="112" r="90" stroke="#f1f5f9" stroke-width="20" fill="none" stroke-linecap="round" />
                                    <circle id="sim-circle" cx="112" cy="112" r="90" stroke="#ef4444" stroke-width="20" fill="none" stroke-dasharray="565" stroke-dashoffset="0" class="transition-all duration-1000 ease-out" stroke-linecap="round" />
                                </svg>
                                <div class="absolute inset-0 flex flex-col items-center justify-center">
                                    <span class="text-6xl font-black text-slate-800 tracking-tighter" id="sim-time">60</span>
                                    <span class="text-sm font-bold text-slate-400 uppercase">Minutes</span>
                                </div>
                            </div>
                            <div id="sim-target-msg" class="text-xs font-black text-red-500 mt-6 bg-red-50 px-4 py-2 rounded-full border border-red-100 animate-pulse">TARGET MISSED (>10m)</div>
                        </div>

                        <!-- ROI Card -->
                        <div class="card p-6 bg-slate-900 text-white border-none shadow-xl relative overflow-hidden group">
                            <div class="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity">
                                <i class="ph ph-currency-dollar text-9xl"></i>
                            </div>
                            <h4 class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-4">Annual Savings Project</h4>
                            <div class="flex justify-between items-end relative z-10">
                                <div>
                                    <span class="text-4xl font-black tracking-tight" id="sim-savings">$0</span>
                                    <p class="text-[10px] text-slate-400 mt-2 font-mono">@ $450/hr Machine Rate</p>
                                </div>
                                <div class="text-right">
                                    <span class="block text-3xl font-bold text-green-400" id="sim-capacity">+0</span>
                                    <span class="text-[10px] text-green-400 uppercase font-bold tracking-wider">Hrs Capacity</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 4: CONTROL (Live Tool) -->
            <div id="view-control" class="view-section hidden animate-fade-in">
                <div class="grid grid-cols-12 gap-6">
                    
                    <!-- Trend Chart -->
                    <div class="col-span-12 card p-6">
                        <div class="flex justify-between items-center mb-4">
                            <h4 class="font-bold text-sm text-slate-700">PDCA Progress: Changeover Reduction</h4>
                            <span class="text-xs font-bold bg-blue-50 text-blue-600 px-3 py-1 rounded-full">Phase 3: Sustain</span>
                        </div>
                        <div class="h-64">
                            <canvas id="trendChart"></canvas>
                        </div>
                    </div>

                    <!-- Digital Andon -->
                    <div class="col-span-12 lg:col-span-6 flex flex-col gap-6">
                        <div class="card p-6 bg-slate-900 border-none text-center relative overflow-hidden">
                            <div class="absolute inset-0 bg-gradient-to-br from-slate-800 to-slate-900"></div>
                            <div class="relative z-10">
                                <span class="text-xs text-slate-400 uppercase font-black tracking-widest">Line Status</span>
                                <div class="mt-4 mb-4 flex justify-center">
                                    <span class="text-5xl font-black text-green-500 drop-shadow-[0_0_10px_rgba(34,197,94,0.5)]">RUNNING</span>
                                </div>
                                <div class="flex justify-center gap-4 text-xs font-bold">
                                    <span class="text-slate-500 bg-slate-800 px-3 py-1 rounded">Target: >90%</span>
                                    <span class="text-green-400 bg-green-900/30 px-3 py-1 rounded border border-green-900/50">Current: 96%</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Panic Button -->
                        <button onclick="triggerPanic()" class="panic-btn w-full py-4 rounded-xl text-white font-black text-lg flex items-center justify-center gap-3 uppercase tracking-widest">
                            <i class="ph ph-siren text-2xl animate-bounce"></i> Andon Pull (Help)
                        </button>
                    </div>
                    
                    <!-- Weld Status -->
                    <div class="col-span-12 lg:col-span-6 flex flex-col gap-4">
                         <div class="card p-6 border-2 border-green-100 bg-green-50/50 text-center flex flex-col justify-center h-full">
                            <span class="text-xs text-green-800 uppercase font-black tracking-widest mb-2">Secondary Bottleneck</span>
                            <div class="w-20 h-20 bg-white rounded-full mx-auto flex items-center justify-center shadow-sm mb-2">
                                <i class="ph ph-fire text-3xl text-orange-500"></i>
                            </div>
                            <div class="text-4xl font-black text-green-700 tracking-tighter">1m 45s</div>
                            <span class="text-xs text-green-600 mt-2 font-bold bg-white px-2 py-1 rounded inline-block mx-auto shadow-sm">Target: < 2 min</span>
                        </div>
                    </div>

                </div>
            </div>

            <!-- VIEW 5: GEMBA & KAIZEN -->
            <div id="view-gemba" class="view-section hidden animate-fade-in">
                <div class="grid grid-cols-12 gap-6 h-full">
                    
                    <!-- Digital Gemba Walk -->
                    <div class="col-span-12 lg:col-span-7 card p-0 overflow-hidden flex flex-col shadow-lg">
                        <div class="bg-slate-900 p-5 border-b border-slate-700 flex justify-between items-center">
                            <div>
                                <h3 class="font-bold text-white flex items-center gap-2 text-lg"><i class="ph ph-eye text-rose-500"></i> Waste Hunter</h3>
                                <p class="text-xs text-slate-400">Digital Gemba Walk Tool</p>
                            </div>
                            <div class="bg-slate-800 px-3 py-1 rounded text-xs font-mono text-green-400 border border-slate-700">
                                Status: Active
                            </div>
                        </div>
                        <div class="p-6 flex-1 overflow-y-auto bg-slate-50">
                            
                            <h4 class="text-xs font-black text-slate-400 uppercase mb-4 tracking-widest">Identify Waste (TIMWOODS)</h4>
                            <div class="space-y-4">
                                <div onclick="captureWaste(this)" class="group p-4 bg-white border-2 border-slate-200 rounded-xl hover:border-rose-400 hover:shadow-lg cursor-pointer transition-all relative overflow-hidden">
                                    <div class="absolute right-0 top-0 bg-rose-500 text-white text-[10px] font-bold px-2 py-1 rounded-bl-lg opacity-0 group-hover:opacity-100 transition-opacity">CLICK TO CAPTURE</div>
                                    <div class="flex items-center gap-4">
                                        <div class="w-10 h-10 rounded-full bg-rose-50 text-rose-500 flex items-center justify-center text-xl group-hover:scale-110 transition-transform">
                                            <i class="ph ph-person-simple-run"></i>
                                        </div>
                                        <div>
                                            <span class="block font-bold text-slate-800">Motion Waste</span>
                                            <span class="text-xs text-slate-500">Operators walking to fetch clamps?</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div onclick="captureWaste(this)" class="group p-4 bg-white border-2 border-slate-200 rounded-xl hover:border-orange-400 hover:shadow-lg cursor-pointer transition-all relative overflow-hidden">
                                    <div class="absolute right-0 top-0 bg-orange-500 text-white text-[10px] font-bold px-2 py-1 rounded-bl-lg opacity-0 group-hover:opacity-100 transition-opacity">CLICK TO CAPTURE</div>
                                    <div class="flex items-center gap-4">
                                        <div class="w-10 h-10 rounded-full bg-orange-50 text-orange-500 flex items-center justify-center text-xl group-hover:scale-110 transition-transform">
                                            <i class="ph ph-hourglass"></i>
                                        </div>
                                        <div>
                                            <span class="block font-bold text-slate-800">Waiting Waste</span>
                                            <span class="text-xs text-slate-500">Machine idle while waiting for crane?</span>
                                        </div>
                                    </div>
                                </div>

                                <div onclick="captureWaste(this)" class="group p-4 bg-white border-2 border-slate-200 rounded-xl hover:border-purple-400 hover:shadow-lg cursor-pointer transition-all relative overflow-hidden">
                                    <div class="absolute right-0 top-0 bg-purple-500 text-white text-[10px] font-bold px-2 py-1 rounded-bl-lg opacity-0 group-hover:opacity-100 transition-opacity">CLICK TO CAPTURE</div>
                                    <div class="flex items-center gap-4">
                                        <div class="w-10 h-10 rounded-full bg-purple-50 text-purple-500 flex items-center justify-center text-xl group-hover:scale-110 transition-transform">
                                            <i class="ph ph-warning-circle"></i>
                                        </div>
                                        <div>
                                            <span class="block font-bold text-slate-800">Defects / Rework</span>
                                            <span class="text-xs text-slate-500">First piece trial run failed?</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mt-6 text-center text-xs text-slate-400 italic">
                                * Click items above to log them instantly
                            </div>
                        </div>
                    </div>

                    <!-- Kaizen Board -->
                    <div class="col-span-12 lg:col-span-5 flex flex-col gap-6">
                        <div class="card p-0 overflow-hidden flex-1 flex flex-col max-h-[500px] shadow-lg">
                            <div class="bg-yellow-50 p-5 border-b border-yellow-100 flex justify-between items-center shrink-0">
                                <div>
                                    <h3 class="font-bold text-yellow-800 flex items-center gap-2 text-lg"><i class="ph ph-lightbulb text-yellow-600 font-fill"></i> Idea Board</h3>
                                </div>
                                <button onclick="addKaizen()" class="text-xs bg-yellow-400 text-yellow-900 border border-yellow-500 px-4 py-2 rounded-lg shadow-sm hover:bg-yellow-300 font-bold transition-colors flex items-center gap-1">
                                    <i class="ph ph-plus-circle font-bold"></i> New Idea
                                </button>
                            </div>
                            <div id="kaizen-container" class="p-6 bg-slate-50 overflow-y-auto space-y-4 flex-1 bg-[url('https://www.transparenttextures.com/patterns/cork-board.png')]">
                                <!-- Sticky Note 1 -->
                                <div class="bg-yellow-200 p-4 shadow-md sticky-note cursor-pointer transform -rotate-1 relative">
                                    <div class="absolute -top-3 left-1/2 -translate-x-1/2 w-4 h-4 rounded-full bg-red-800/20 shadow-inner"></div>
                                    <p class="text-xs font-bold text-yellow-900 mb-2 uppercase tracking-wide opacity-50">Observation</p>
                                    <p class="text-sm text-slate-800 font-handwriting leading-snug">"Red pen cap didn't fit yesterday. We need to check incoming material specs."</p>
                                    <div class="mt-3 pt-2 border-t border-yellow-300/50 flex justify-between items-center">
                                        <span class="text-[10px] text-yellow-800 font-bold">Op 2</span>
                                    </div>
                                </div>

                                <!-- Sticky Note 2 -->
                                <div class="bg-green-200 p-4 shadow-md sticky-note cursor-pointer transform rotate-2 relative">
                                    <div class="absolute -top-3 left-1/2 -translate-x-1/2 w-4 h-4 rounded-full bg-red-800/20 shadow-inner"></div>
                                    <p class="text-xs font-bold text-green-900 mb-2 uppercase tracking-wide opacity-50">Kaizen</p>
                                    <p class="text-sm text-slate-800 font-handwriting leading-snug">"Mark the floor for the tool cart so we don't have to look for it."</p>
                                    <div class="mt-3 pt-2 border-t border-green-300/50 flex justify-between items-center">
                                        <span class="text-[10px] text-green-800 font-bold">Team Lead</span>
                                        <i class="ph ph-check-circle text-green-700 text-lg"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

        </div>
    </main>

    <script>
        // --- Navigation Logic ---
        function switchTab(tabId) {
            document.querySelectorAll('.view-section').forEach(el => el.classList.add('hidden'));
            document.getElementById('view-' + tabId).classList.remove('hidden');
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            document.getElementById('btn-' + tabId).classList.add('active');

            const titles = {
                'define': { t: 'Define the Problem', s: 'Stamping Die Changeover Delays' },
                'map': { t: 'Process Map', s: 'Value Stream Analysis' },
                'countermeasures': { t: 'Improvement Simulator', s: 'Model SMED Impact' },
                'control': { t: 'Shop Floor Control', s: 'Live Operator Assistant' },
                'gemba': { t: 'Gemba & Continuous Improvement', s: 'Field Observations & Kaizen Log' }
            };
            document.getElementById('page-title').innerText = titles[tabId].t;
            document.getElementById('page-subtitle').innerText = titles[tabId].s;

            if (tabId === 'define' || tabId === 'control') {
                setTimeout(renderCharts, 100);
            }
        }

        // --- Chart Logic ---
        function renderCharts() {
            // 1. Loss Chart
            const ctxLoss = document.getElementById('lossChart');
            if(ctxLoss) {
                if (Chart.getChart("lossChart")) Chart.getChart("lossChart").destroy();
                new Chart(ctxLoss, {
                    type: 'bar',
                    indexAxis: 'y',
                    data: {
                        labels: ['Setup (Changeover)', 'Breakdowns', 'Minor Stops', 'Speed Loss', 'Defects'],
                        datasets: [{
                            label: 'Hours Lost / Month',
                            data: [44, 12, 8, 5, 2],
                            backgroundColor: ['#e11d48', '#94a3b8', '#94a3b8', '#94a3b8', '#94a3b8'],
                            borderRadius: 6,
                            barThickness: 24
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { display: false } },
                        scales: { x: { grid: { display: false } }, y: { grid: { display: false } } }
                    }
                });
            }

            // 2. Composition Chart
            const ctxComp = document.getElementById('compositionChart');
            if(ctxComp) {
                if (Chart.getChart("compositionChart")) Chart.getChart("compositionChart").destroy();
                new Chart(ctxComp, {
                    type: 'bar',
                    data: {
                        labels: ['Total Time'],
                        datasets: [
                            { label: 'Value Added (Run)', data: [65], backgroundColor: '#22c55e', barThickness: 50, borderRadius: {topLeft: 6, bottomLeft: 6} },
                            { label: 'Non-Value Added (Setup)', data: [35], backgroundColor: '#e11d48', barThickness: 50, borderRadius: {topRight: 6, bottomRight: 6} }
                        ]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { position: 'bottom' } },
                        scales: { x: { stacked: true, max: 100, grid: { display: false } }, y: { stacked: true, grid: { display: false }, display: false } }
                    }
                });
            }

            // 3. Trend Chart
            const ctxTrend = document.getElementById('trendChart');
            if(ctxTrend) {
                if (Chart.getChart("trendChart")) Chart.getChart("trendChart").destroy();
                new Chart(ctxTrend, {
                    type: 'line',
                    data: {
                        labels: ['Baseline (Current)', 'Exp 1: Tools/Seq', 'Exp 2: Clamps (SMED)', 'Sustain', 'Future State'],
                        datasets: [{
                            label: 'Setup Time (min)',
                            data: [60, 30, 10, 9, 8],
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            fill: true,
                            tension: 0.4,
                            pointRadius: 6,
                            pointBackgroundColor: '#fff',
                            pointBorderWidth: 3
                        },
                        {
                            label: 'Target (<10m)',
                            data: [10, 10, 10, 10, 10],
                            borderColor: '#22c55e',
                            borderDash: [5, 5],
                            pointRadius: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { position: 'top' } },
                        scales: { y: { beginAtZero: true } }
                    }
                });
            }
        }

        // --- VSM Interactive Logic ---
        function toggleVSM(state) {
            const btnC = document.getElementById('vsm-btn-current');
            const btnF = document.getElementById('vsm-btn-future');
            const co = document.getElementById('val-stamping-co');
            const avail = document.getElementById('val-stamping-avail');
            const inv = document.getElementById('val-inventory');
            const ladder = document.getElementById('ladder-lead');
            const weldCo = document.getElementById('val-weld-co');

            if (state === 'future') {
                btnF.classList.add('bg-slate-800', 'text-white', 'shadow-lg');
                btnF.classList.remove('text-slate-500', 'hover:bg-white/50');
                btnC.classList.remove('bg-white', 'shadow-md', 'text-slate-800');
                btnC.classList.add('text-slate-500', 'hover:bg-white/50');

                // Update Values
                co.innerHTML = '<span>C/O:</span> <b>< 10 min</b>';
                co.className = 'flex justify-between text-green-600 font-bold bg-green-50 px-1 rounded';
                avail.innerHTML = '<span>Avail:</span> <b>96%</b>';
                inv.innerHTML = 'Reduced';
                inv.className = 'text-xs font-bold text-green-600 mt-2 bg-green-50 px-2 py-1 rounded border border-green-100';
                weldCo.innerHTML = '<span>C/O:</span> <b>< 2 min</b>';
                weldCo.className = 'flex justify-between text-green-600 font-bold';
                ladder.innerHTML = '<span class="uppercase tracking-widest opacity-50 text-[10px]">Total Lead Time</span><span class="text-2xl animate-pulse">4.5 Days</span>';
                ladder.className = 'flex-1 bg-green-50 p-4 text-center text-green-700 font-black border-r-2 border-slate-300 transition-all flex flex-col items-center justify-center gap-1';
                
                // Confetti for Future State
                confetti({ particleCount: 50, spread: 60, origin: { y: 0.7 } });
            } else {
                btnC.classList.add('bg-white', 'shadow-md', 'text-slate-800');
                btnC.classList.remove('text-slate-500', 'hover:bg-white/50');
                btnF.classList.remove('bg-slate-800', 'text-white', 'shadow-lg');
                btnF.classList.add('text-slate-500', 'hover:bg-white/50');

                // Reset
                co.innerHTML = '<span>C/O:</span> <b>60 min</b>';
                co.className = 'flex justify-between text-red-600 font-bold bg-red-50 px-1 rounded';
                avail.innerHTML = '<span>Avail:</span> <b>85%</b>';
                inv.innerHTML = 'Huge WIP';
                inv.className = 'text-xs font-bold text-red-600 mt-2 bg-red-50 px-2 py-1 rounded border border-red-100';
                weldCo.innerHTML = '<span>C/O:</span> <b>10 min</b>';
                weldCo.className = 'flex justify-between text-orange-600 font-bold';
                ladder.innerHTML = '<span class="uppercase tracking-widest opacity-50 text-[10px]">Total Lead Time</span><span class="text-2xl">9 Days</span>';
                ladder.className = 'flex-1 bg-red-50 p-4 text-center text-red-700 font-black border-r-2 border-slate-300 transition-all flex flex-col items-center justify-center gap-1';
            }
        }

        // --- Simulator Logic ---
        function updateSimulation() {
            let currentTime = 60; 
            const toggles = document.querySelectorAll('.impact-toggle:checked');
            toggles.forEach(t => currentTime -= parseInt(t.value));

            document.getElementById('sim-time').innerText = currentTime;
            const circle = document.getElementById('sim-circle');
            const dashOffset = 565 * (1 - (currentTime / 60));
            circle.style.strokeDashoffset = dashOffset;

            if (currentTime <= 10) {
                circle.style.stroke = '#22c55e';
                const msg = document.getElementById('sim-target-msg');
                msg.innerText = "TARGET ACHIEVED! 🎉";
                msg.className = "text-xs font-black text-green-600 mt-6 bg-green-50 px-4 py-2 rounded-full border border-green-100 animate-bounce";
                
                // Trigger Confetti
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
            } else {
                circle.style.stroke = '#ef4444';
                const msg = document.getElementById('sim-target-msg');
                msg.innerText = "TARGET MISSED (>10m)";
                msg.className = "text-xs font-black text-red-500 mt-6 bg-red-50 px-4 py-2 rounded-full border border-red-100";
            }

            const timeSavedPerSetup = 60 - currentTime;
            const setupsPerMonth = 44; 
            const hourlyRate = 450;
            const hoursSaved = (timeSavedPerSetup * setupsPerMonth) / 60;
            const dollarsSaved = hoursSaved * hourlyRate;

            document.getElementById('sim-capacity').innerText = "+" + hoursSaved.toFixed(1);
            document.getElementById('sim-savings').innerText = "$" + dollarsSaved.toLocaleString(undefined, {maximumFractionDigits:0});
        }

        // --- Panic Button Logic ---
        function triggerPanic() {
            const overlay = document.getElementById('panic-overlay');
            overlay.style.display = 'flex';
            
            // Play sound effect (optional/browser dependent, omitting for safety but visual is enough)
            
            setTimeout(() => {
                overlay.style.display = 'none';
                showToast("Maintenance Team Alerted!", "error");
            }, 3000);
        }

        // --- Waste Hunter Game Logic ---
        function captureWaste(element) {
            // Visual Effect
            element.classList.add('border-green-500', 'bg-green-50');
            element.classList.remove('border-slate-200', 'bg-white');
            
            const icon = element.querySelector('i');
            icon.classList.remove('text-rose-500', 'text-orange-500', 'text-purple-500');
            icon.classList.add('text-green-500', 'scale-125');
            
            showToast("Waste Captured! +10 Points");
            
            // Reset after delay
            setTimeout(() => {
                element.classList.remove('border-green-500', 'bg-green-50');
                element.classList.add('border-slate-200', 'bg-white');
                icon.classList.remove('text-green-500', 'scale-125');
                // Re-add original colors would need complex logic, keeping simple reset
                icon.classList.add('text-slate-400'); 
            }, 2000);
        }

        // --- KAIZEN Logic ---
        function addKaizen() {
            const container = document.getElementById('kaizen-container');
            const ideas = ["Install a shadow board.", "Rotate the raw material bin.", "Label the hydraulic hoses.", "Create a dedicated cart."];
            const randomIdea = ideas[Math.floor(Math.random() * ideas.length)];
            
            const newNote = document.createElement('div');
            newNote.className = 'bg-blue-200 p-4 shadow-md sticky-note cursor-pointer transform rotate-1 relative animate-fade-in';
            newNote.innerHTML = `
                <div class="absolute -top-3 left-1/2 -translate-x-1/2 w-4 h-4 rounded-full bg-red-800/20 shadow-inner"></div>
                <p class="text-xs font-bold text-blue-900 mb-2 uppercase tracking-wide opacity-50">Idea</p>
                <p class="text-sm text-slate-800 font-handwriting leading-snug">"${randomIdea}"</p>
                <div class="mt-3 pt-2 border-t border-blue-300/50 flex justify-between items-center">
                    <span class="text-[10px] text-blue-800 font-bold">You</span>
                    <span class="text-[10px] font-bold text-blue-600">Just Now</span>
                </div>
            `;
            container.prepend(newNote);
        }

        // --- TOAST NOTIFICATION SYSTEM ---
        function showToast(message, type = "success") {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = 'toast';
            const borderColor = type === 'error' ? '#ef4444' : '#22c55e';
            const icon = type === 'error' ? '<i class="ph ph-warning-circle text-red-500 text-2xl"></i>' : '<i class="ph ph-check-circle text-green-500 text-2xl"></i>';
            
            toast.style.borderLeftColor = borderColor;
            toast.innerHTML = `${icon}<div><p class="text-sm font-bold text-slate-800">System Notification</p><p class="text-xs text-slate-500">${message}</p></div>`;
            
            container.appendChild(toast);
            setTimeout(() => toast.classList.add('show'), 10);
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Init
        window.onload = function() {
            renderCharts();
        };

    </script>
</body>
</html>
